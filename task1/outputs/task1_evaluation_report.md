# Task1 评估结果总结报告

**生成日期**: 2026年2月1日  
**项目**: 2026 MCM Problem C - 《与星共舞》观众偏好建模

---

## 1. 概述

Task1 的核心目标是从《与星共舞》历史数据中估计"观众偏好/人气过程"与规则参数。本报告总结了基于 PyTorch 变分推断模型的最终评估结果。

### 1.1 模型基本信息

| 指标 | 值 |
|------|-----|
| 季数 (n_seasons) | 34 |
| 特征数 (n_features) | 28 |
| 后验采样数 (n_posterior_samples) | 200 |
| 有效预测周数 (total_valid_weeks) | 264 |

---

## 2. 核心性能指标

### 2.1 预测后验检验 (PPC) 指标

| 指标 | 值 | 说明 |
|------|-----|------|
| **准确率 (Accuracy)** | **81.06%** | 正确预测淘汰选手的比例 |
| **Cover@2** | **91.90%** | 真实淘汰者在预测概率前2名中的比例 |
| 正确预测数 | 214 | 正确预测的淘汰周数 |
| 总有效周数 | 264 | 用于评估的总周数 |

> **评价**: 模型达到了 81% 的淘汰预测准确率，Cover@2 指标高达 91.9%，表明模型具有良好的预测能力和可靠性。

### 2.2 可行性指标

| 指标 | 值 |
|------|-----|
| 平均可行率 (mean_feasible_rate) | 79.24% |
| 最小可行率 (min_feasible_rate) | 0.0% |

> **说明**: 可行率衡量模型预测的淘汰概率分布在规则约束下的有效性。

### 2.3 不确定性量化

| 指标 | 值 | 说明 |
|------|-----|------|
| 90% 置信区间平均宽度 | 0.253 | 后验估计的不确定性范围 |
| 95% 置信区间平均宽度 | 0.310 | 更宽的置信水平 |
| 平均熵 (mean_entropy) | 1.15 | 预测概率分布的不确定性度量 |

---

## 3. 特征重要性分析

### 3.1 显著特征 (Significant Features)

以下特征的贝叶斯后验置信区间不包含零，被认为具有统计显著性：

| 特征 | 系数均值 (β) | 标准差 | 95% CI | 影响方向 |
|------|-------------|--------|--------|----------|
| **industry_Model** | -1.654 | 0.237 | [-2.12, -1.19] | 强负向 (更易淘汰) |
| **homecountry_is_us** | +0.433 | 0.157 | [0.12, 0.74] | 正向 (美国选手更受欢迎) |
| **industry_Athlete** | +0.418 | 0.166 | [0.09, 0.74] | 正向 (运动员更受欢迎) |
| **age_z** | -0.396 | 0.067 | [-0.53, -0.26] | 负向 (年龄越大越不利) |

### 3.2 特征影响解读

1. **职业背景**: 
   - 模特 (Model) 背景的选手显著更易被淘汰 (β = -1.65)
   - 运动员 (Athlete) 背景的选手更受观众欢迎 (β = +0.42)

2. **地域因素**:
   - 美国本土选手具有优势 (β = +0.43)

3. **年龄因素**:
   - 年龄与观众支持度呈负相关 (β = -0.40)

### 3.3 非显著但有趋势的特征

| 特征 | 系数均值 | 趋势 |
|------|---------|------|
| Racing Driver | +0.81 | 正向趋势 |
| Fitness Instructor | +0.75 | 正向趋势 |
| Motivational Speaker | +0.74 | 正向趋势 |
| Politician | +0.66 | 正向趋势 |
| Entrepreneur | -0.75 | 负向趋势 |
| Con artist | -0.74 | 负向趋势 |

---

## 4. 敏感性分析结果

### 4.1 实验概况

| 项目 | 值 |
|------|-----|
| 总实验数 | 24 |
| 总耗时 | 10.21 分钟 |
| 平均单次实验耗时 | ~25.5 秒 |

### 4.2 参数网格

```
epsilon: [0.005, 0.01]
tau:     [0.1, 0.2, 0.3]
kappa:   [20]
lambda_ent: [0.0, 0.05, 0.1, 0.2]
```

### 4.3 最优参数配置

#### 按准确率最优

| 参数 | 值 |
|------|-----|
| epsilon | 0.01 |
| tau | 0.2 |
| kappa | 20 |
| lambda_ent | 0.2 |
| **Accuracy** | **81.48%** |
| Cover@2 | 92.19% |
| ELBO | -946.20 |

#### 按 ELBO 最优

| 参数 | 值 |
|------|-----|
| epsilon | 0.01 |
| tau | 0.2 |
| kappa | 20 |
| lambda_ent | 0.05 |
| Accuracy | 78.91% |
| Cover@2 | 90.40% |
| **ELBO** | **-834.90** |

### 4.4 敏感性分析发现

- **epsilon 参数**: 0.01 相比 0.005 在准确率上表现更优
- **tau 参数**: 0.2 为最佳值，过高 (0.3) 或过低 (0.1) 都会降低性能
- **lambda_ent 参数**: 熵正则化对准确率有正面影响，0.2 达到最高准确率

---

## 5. 各赛季预测表现

基于 `ppc_details.csv` 的部分数据展示：

| 赛季 | 规则类型 | 预测表现 |
|------|---------|----------|
| Season 1 | rank | 2/3 正确 (66.7%) |
| Season 2 | rank | 6/7 正确 (85.7%) |
| Season 3 | percent | 6/7 正确 (85.7%) |
| Season 4 | percent | 7/8 正确 (87.5%) |
| Season 5 | percent | 7/9 正确 (77.8%) |
| Season 6 | percent | 7/8 正确 (87.5%) |
| Season 7 | percent | 8/8 正确 (100%) |

> 注：早期赛季 (Season 1-2) 采用排名规则，后期赛季主要采用百分比规则。

---

## 6. 生成的输出文件

### 6.1 数据文件

| 文件名 | 说明 |
|--------|------|
| `fan_share_estimates.csv` | 粉丝份额估算表 |
| `posterior_summary.npz` | 后验参数汇总 (NumPy 格式) |
| `ppc_details.csv` | 详细预测对比 (266行) |
| `ppc_metrics.json` | PPC 汇总指标 |
| `feasibility_metrics.json` | 可行性指标 |
| `feature_importance.csv` | 特征重要性 (28个特征) |
| `social_proxy.csv` | 社交代理指标 |
| `task1_report.json` | 综合报告 |

### 6.2 可视化图表

| 文件名 | 说明 |
|--------|------|
| `plots/certainty_heatmap.png` | 确定性热力图 |
| `plots/entropy_heatmap.png` | 熵热力图 |
| `plots/feature_forest_plot.png` | 特征森林图 |
| `plots/ppc_accuracy_by_season.png` | 各赛季准确率分布图 |

### 6.3 模型文件

| 文件名 | 说明 |
|--------|------|
| `run_torch/best_model.pt` | 最优模型权重 |
| `run_torch/final_model.pt` | 最终模型权重 |
| `run_torch/checkpoint_epoch*.pt` | 训练检查点 |
| `run_torch/posterior_params.json` | 后验参数 JSON |
| `run_torch/theta_mean.npy` | θ 均值参数 |

---

## 7. 结论与建议

### 7.1 主要结论

1. **模型性能优秀**: 81% 的淘汰预测准确率和 92% 的 Cover@2 指标表明模型具有可靠的预测能力

2. **关键发现**:
   - 选手职业背景对观众投票有显著影响
   - 模特职业背景显著降低选手胜出概率
   - 运动员背景和美国国籍对选手有正面影响
   - 年龄与受欢迎程度负相关

3. **参数敏感性**: 模型对 epsilon 和 tau 参数较为敏感，建议使用 epsilon=0.01, tau=0.2 的配置

### 7.2 改进建议

1. 考虑引入时序特征以捕捉选手在比赛中的动态表现
2. 探索更多社交媒体相关特征
3. 针对不同赛季规则分别建模可能进一步提升性能

---

## 8. 附录

### 8.1 技术栈

- **框架**: PyTorch
- **推断方法**: 变分推断 (Variational Inference)
- **优化器**: 支持 GPU 加速、早停、余弦退火学习率

### 8.2 配置文件位置

```
code/task1/config/
├── task1_debug_fast.json
├── task1_torch.json
├── task1_train.json
└── task1_ultrafast.json
```

### 8.3 运行命令

```bash
# 训练模型
python code/scripts/task1_run_torch.py --config docs/task1_debug_fast.json

# 生成结果
python code/scripts/task1_postprocess.py

# 敏感性分析
python code/scripts/task1_sensitivity.py
```

---

*报告自动生成于 Task1 评估流程*
